<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pleurs et pilositÃ©</title>
    <style>
                body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            background-color: #ffebcd;
            background-image: url('https://www.transparenttextures.com/patterns/snow.png');
            margin: 0;
            overflow-y: auto;  /* Added for scrolling if needed */
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #d32f2f;
            font-family: 'Comic Sans MS', cursive;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
        }


        
        /* User status */
        #userStatus {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.2em;
            color: #a23636;
        }
               /* Instructions section */
        #instructions {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            text-align: center;
            max-width: 1000px;
            font-size: 1.2em;
            color: #333;
            overflow-y: auto;  /* Added for scrolling if needed */
            max-height: 400px; /* Set a maximum height */

        }
       
       
    </style>
</head>
<body>
    <h1>ğŸ§”Pleurs et pilositÃ©ğŸ§”</h1>
    <div id="instructions">
        <p>Ã€ trois jours de NoÃ«l, lâ€™effervescence atteignait son comble Ã  lâ€™atelier du Topapa. Mais avant de sâ€™emballer, une tÃ¢che essentielle les attendait : vÃ©rifier le bon Ã©tat du traÃ®neau. Topapa, accompagnÃ© de Dudley, se dirigea vers le hangar oÃ¹ la vieille machine reposait.</p>
 <p>Â« Ah, cette beautÃ©... Â» soupira Topapa en posant une main affectueuse sur le traÃ®neau poussiÃ©reux. Â« Câ€™est un modÃ¨le Ã‰vasion 2004. Un classique ! On nâ€™en fabrique plus des comme Ã§a. Mais bon, il vieillit. Je prÃ©fÃ¨re toujours faire un test pour voir sâ€™il dÃ©marre. Le moteur a tendance Ã  faire des caprices. Â»</p>
 <p>Dudley fronÃ§a les sourcils. Â« Le moteur ? Maisâ€¦ les traÃ®neaux ne sont pas censÃ©s Ãªtre tirÃ©s par des rennes ? Â»</p>
 <p>Â« Bien sÃ»r, Â» rÃ©pondit Topapa en haussant les Ã©paules. Â« Mais entre toi et moi, les rennes ne sont pas fiables Ã  100 %. Ils peuvent nous lÃ¢cher Ã  tout moment. Alors jâ€™ai ajoutÃ© un moteur pour avoir une sÃ©curitÃ©. Â»v
 <p>Dudley Ã©clata de rire. Â« Ah, câ€™est donc Ã§a ton plan B ? Pas bÃªte. Mais justement, oÃ¹ sont tes rennes ? Â»</p>
 <p>Ils se dirigÃ¨rent vers lâ€™Ã©curie, curieux de voir ce que faisaient Loris, Artaban, Phasme, et RaseToiLaMoustache. En entrant, un spectacle dÃ©solant les accueillit : les quatre rennes Ã©taient affalÃ©s sur le sol, visiblement victimes dâ€™une gueule de bois carabinÃ©e. Des bouteilles jonchaient le sol, tÃ©moins silencieux dâ€™une nuit de fÃªte bien trop arrosÃ©e. Non, loin on trouvait une Switch encore allumÃ©e oÃ¹ une partie de Smash Bros avait Ã©tÃ© mis en pause. </p>
 <p>Topapa soupira. Â« La classique. Â»</p>
 <p>Phasme leva une tÃªte misÃ©rable et grogna dâ€™une voix rauque : Â« Pas si fort, chefâ€¦ Le bateau commenÃ§ait tout juste Ã  sâ€™arrÃªter de tanguerâ€¦ Â»</p>
 <p>Topapa secoua la tÃªte, dÃ©Ã§u mais pas surpris. Â« NoÃ«l est dans trois jours ! Allez, il est temps de vous remettre en forme. Â»</p>
 <p>Dudley, enthousiaste, intervint. Â« Laissez-moi faire. Je vais leur donner un bon entraÃ®nement. Â»</p>
 <p>De retour Ã  lâ€™atelier, Topapa constata que lâ€™ambiance Ã©tait bouillonnante. Les BÃ©bÃ©s Romain travaillaient Ã  une vitesse impressionnante, multipliant les jouets, empaquetant les cadeaux et finalisant les moindres dÃ©tails.</p>
 <p>Â« SacrÃ© rythme ici, Â» commenta Topapa en levant les yeux. Il aperÃ§ut alors GrinchÃ©mie, debout sur la mezzanine, dominant la scÃ¨ne comme un gÃ©nÃ©ral au front.</p>
 <p>Â« FÃ©licitations, GrinchÃ©mie, Â» lanÃ§a-t-il. Â« Je ne sais pas comment tu as rÃ©ussi Ã  les motiver, mais quel travail dâ€™Ã©quipe ! Â»</p>
 <p>GrinchÃ©mie haussa nonchalamment les Ã©paules. Â« Oh, tu sais, le tact, le contact humain, Ã§a me connaÃ®t. Je sais leur parler avec douceur et bienveillance. Ã‡a les motive tout de suite. Â»</p>
 <p>Ã€ cet instant, un cri Ã©touffÃ© attira lâ€™attention de Topapa. En contrebas, il aperÃ§ut un BÃ©bÃ© Romain enfermÃ© dans la prison de la torture.</p>
 <p>Â« Euhâ€¦ et lui, quâ€™est-ce quâ€™il fait lÃ  ? Â» demanda-t-il.</p>
 <p>Â« Oh, lui ? Â» rÃ©pondit GrinchÃ©mie en tournant Ã  peine la tÃªte. Â« Il a eu lâ€™audace de demander une pause pour aller aux toilettes. Â»</p>
 <p>Topapa haussa un sourcil, mais prÃ©fÃ©ra ne pas insister. AprÃ¨s tout, le travail avanÃ§ait Ã  un rythme spectaculaire, et NoÃ«l devait Ãªtre prÃªt Ã  temps.</p>
 <p>Un bruit sourd de Â« CHOLLAY ! Â» retentit soudain depuis la grange. IntriguÃ©, Topapa sâ€™y prÃ©cipita et dÃ©couvrit Dudley, raquette Ã  la main, disputant un match de ping-pongâ€¦ contre les rennes.</p>
 <p>Â« Ah, Topapa ! Â» sâ€™exclama Dudley, triomphant. Â« Regarde, je les fais bien courir. Allez, Artaban, essaye de renvoyer Ã§a. Oh, 11-0, miskine toi ! Ã‡a passe sous la table. Â»</p>
 <p>Topapa secoua la tÃªte, partagÃ© entre lâ€™amusement et lâ€™exaspÃ©ration. Mais au moins, les rennes faisaient de lâ€™exerciceâ€¦</p>
 <p>De retour dans lâ€™atelier, GrinchÃ©mie annonÃ§a dâ€™une voix autoritaire : Â« Pause. Vous avez cinq minutes pour faire ce que vous voulez : dormir, manger ou jouer aux cartes. Je mâ€™en fiche, mais dans cinq minutes, je veux tout le monde Ã  lâ€™Å“uvre. Â»</p>
 <p>Les BÃ©bÃ©s Romain sâ€™Ã©croulÃ¨rent immÃ©diatement sur leurs chaises, Ã©puisÃ©s mais reconnaissants. Cependant, deux minutes plus tard, Topapa remarqua Dudley dans un coin, boudant, les larmes aux yeux.</p>
 <p>Â« Quâ€™est-ce qui tâ€™arrive ? Â» demanda-t-il, inquiet.</p>
 <p>Dudley renifla. Â« Jâ€™ai pris le dernier valetâ€¦ Â»</p>
 <p>Topapa soupira, mais un petit sourire apparut sur son visage. Les prÃ©paratifs, aussi chaotiques soient-ils, avanÃ§aient Ã  leur maniÃ¨re. NoÃ«l serait prÃªt, comme toujours.</p>
 <p>Explication du jeu : Ca part sur un barbu. Votre score sera soustrait Ã  100 et ajoutÃ© Ã  la base de donnÃ©es. Mais de manche Ã  valets cette fois, enfin, sauf si la majoritÃ© le souhaite â€¦ 
</p>
         </div>
  
    <div id="highest-score">Meilleur score: 0</div>
     <div id="userStatus"></div>

   <script defer type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC4bjg7lVwd8FU8MREaPhBsBENv5qmiYYM",
            authDomain: "calendrier-de-l-avent-54e3a.firebaseapp.com",
            databaseURL: "https://calendrier-de-l-avent-54e3a-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "calendrier-de-l-avent-54e3a",
            storageBucket: "calendrier-de-l-avent-54e3a.appspot.com",
            messagingSenderId: "850639567855",
            appId: "1:850639567855:web:0d799a1ecca005fcff141a",
            measurementId: "G-PC1W7RYVEH"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        let userId = '';
        let highestScoreGame24 = 0

        const highestScoreDisplay = document.getElementById('highest-score');


        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                document.getElementById('userStatus').innerText = `Bienvenue : ${user.email}`;

                const userRef = doc(db, 'users', userId);
                const docSnap = await getDoc(userRef);

                if (!docSnap.exists()) {
                    await setDoc(userRef, { userId: userId, highestScoreGame24: 0, UserEmail: user.email });
                } else {
                    const userData = docSnap.data();
                    highestScoreGame24 = userData.highestScoreGame24 || 0;

                    UserEmail: user.email
                    
                    highestScoreDisplay.innerText = `Meilleur score: ${highestScoreGame24}`;
                    
                    
                }
            } else {
                window.location.href = 'login.html';
            }
        });

    </script>
</body>
</html>
