<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Qui Maman pr√©f√®re t-elle ? </title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            background-color: #ffebcd;
            background-image: url('https://www.transparenttextures.com/patterns/snow.png');
            margin: 0;
        }
        /* Christmas themed title */
        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #d32f2f;
            font-family: 'Comic Sans MS', cursive;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
        }
        #userStatus {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.2em;
        }
                
        /* Instructions section */
        #instructions {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            text-align: center;
            max-width: 1000px;
            font-size: 1.2em;
            color: #333;
            overflow-y: auto;  /* Added for scrolling if needed */
            max-height: 300px; /* Set a maximum height */
        }
        #gameArea {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }
        #start-btn {
            padding: 10px 20px;
            margin: 10px;
            font-size: 1.5em;
            cursor: pointer;
            background-color: #007BFF;
            color: white;
            border: none;
        }
        #start-btn:hover {
            background-color: #0056b3;
        }

        #next-question-btn {
    padding: 10px 20px;
    margin: 10px;
    font-size: 1.5em;
    cursor: pointer;
    background-color: #007BFF;
    color: white;
    border: none;
    display: none; /* Keeps it hidden initially */
}

#next-question-btn:hover {
    background-color: #0056b3;
}
        
        #question {
            font-size: 1.5em;
            margin: 20px;
        }
        #options {
            font-size: 1.2em;
            margin: 10px;
        }
        #timer, #score {
            font-size: 1.5em;
            margin: 10px;
        }
        #input {
            padding: 10px;
            font-size: 1.2em;
            margin: 10px;
            width: 50px;
        }
      
      

    </style>
</head>
<body>

    <h1>üíÅ‚Äç‚ôÄÔ∏è Qui Maman pr√©f√®re t-elle ? üíÅ‚Äç‚ôÄÔ∏è</h1>
    <div id="userStatus"></div>
    
 <!-- Game instructions -->
    <div id="instructions">
        <p>¬´ Bon, on rentre quand ? ¬ª Topapa soupira, conscient que ses serviteurs, les b√©b√©s Romain, devaient s‚Äôinqui√©ter de l‚Äôabsence de leur leader charismatique. Loris, Artaban et Phasme, laiss√©s √† eux-m√™mes, devaient probablement mourir de faim si personne n'√©tait l√† pour leur pr√©parer √† manger, les nourrir et nettoyer leur liti√®re. √Ä la simple pens√©e de ses amis rennes, une vague de nostalgie envahit RaseToiLaMoustache. C‚Äô√©tait vrai, ces compagnons lui manquaient. Mais au fond, il appr√©ciait de plus en plus le temps pass√© avec ses nouveaux camarades.</p>
<p>La derni√®re partie de Galerapagos avait √©t√© m√©morable : Dudley, dans un √©lan d‚Äôh√©ro√Øsme inattendu, avait donn√© la balle √† Topapa, qui avait ensuite r√©ussi √† √©liminer tout le monde sur le terrain. Et encore plus fort, la fois pr√©c√©dente o√π Dudley, dans un √©lan d‚Äôh√©ro√Øsme inattendu, avait donn√© la balle √† Topapa, qui avait ensuite r√©ussi √† √©liminer tout le monde sur le terrain. Ah, quels beaux souvenirs. Mais son devoir de l√¢cheur l‚Äôappelait.</p>
<p>Il se rem√©mora alors sa derni√®re partie de Galerapagos avec ses amis. La derni√®re fois, son camarade Amance lui avait offert une planche en bois, lui offrant une √©chappatoire pour quitter la partie au lieu de le laisser mourir dans un √©clat de moqueries. Cela l‚Äôavait profond√©ment √©nerv√©. Comment peut-on manquer √† ce point de respect pour l‚Äôart du jeu ? Et √† leur derni√®re partie de LL, Amance lui avait m√™me laiss√© marquer un point, au lieu de s‚Äôacharner sur lui pour qu‚Äôil soit Bobby. Quel manque d‚Äô√©l√©gance !</p>
<p>Percevant l‚Äôh√©sitation de son camarade, Dudley se leva et lui fit un c√¢lin chaleureux, cherchant √† le motiver √† rester avec eux. La sensation de la t√™te de RaseToiLaMoustache sur son nombril l‚Äôenveloppa d‚Äôun r√©confort apaisant. Grinch√©mie, elle aussi, ressentit une envie de montrer son amour envers son ami dans une √©treinte, mais elle se ravisa en regardant le plaid qui tr√¥nait sur ses √©paules, probablement plus contamin√© que le bec d‚Äôun doudou bien connu.</p>
<p>Topapa, aurait aussi voulu montrer son amour envers son renne serviable. Il aurait souhait√© lui dire combien il prenait plaisir √† jouer avec lui, √† partager ces moments de coop√©ration ou de comp√©tition. Il aurait voulu lui faire savoir √† quel point il appr√©ciait son imagination et la fa√ßon dont il cr√©ait des jeux fascinants pour Dudley. Mais aussi sa curiosit√© et sa volont√© d'apprendre de nouvelles choses l'impressionnaient. Il apportait r√©guli√®rement √† la table des nouveaux concepts de jeux et sa pr√©sence √©tait un vrai bonheur pour lui. Bref il voulait dire qu‚Äôil l‚Äôaimait tr√®s fort  mais peu prompt aux effusions de sentiments, se contenta de coder un site internet pour lui exprimer son affection, ce qui, il fallait l‚Äôadmettre, prenait un peu plus de temps.</p>
<p>Soudain, B√©b√© Romain descendit les escaliers, son ordinateur en main, l'excitation palpable sur son visage. ¬´ J‚Äôai fait une chasse au tr√©sor, ¬ª annon√ßa-t-il fi√®rement, les yeux brillants d‚Äôenthousiasme. Les quatre comp√®res √©chang√®rent un regard, peu emball√©s par l‚Äôid√©e. Mais B√©b√© Romain, d√©termin√© √† faire bonne impression, ajouta : ¬´ Sinon, j‚Äôai fait un Kahoot ‚ÄòVrai/Faux‚Äô purement subjectif, o√π, peu importe la r√©ponse, c‚Äôest mon point de vue qui compte. ¬ª</p>
<p>¬´ Le Kahoot ! ¬ª s‚Äô√©cri√®rent √† l‚Äôunisson les quatre autres. 
</p>

        <p>Explication du jeu : Simple quizz  R√©ponds par A,B,C, D ou E en appuyant sur entr√©e (majuscule ou minuscule) √† chaque question. Tu disposes de 30 secondes par question et chaque bonne r√©ponse vaut 2.5 points.</p>
        <p>Il y a 40 questions. Attention seul le premier score est pris en compte. Possible sur Smartphone.
</p>
    </div>
    
    <div id="gameArea">
        <button id="start-btn">üéÖStart GameüéÖ</button>
        <div id="timer"></div>
        <div id="score"></div>
        <button id="next-question-btn" style="display: none;">Prochaine question</button>
        <div id="question"></div>
        <div id="options"></div>
        <input type="text" id="input" placeholder="A/B/C/D" maxlength="1" disabled>
      

      
    </div>

    <script defer type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC4bjg7lVwd8FU8MREaPhBsBENv5qmiYYM",
            authDomain: "calendrier-de-l-avent-54e3a.firebaseapp.com",
            databaseURL: "https://calendrier-de-l-avent-54e3a-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "calendrier-de-l-avent-54e3a",
            storageBucket: "calendrier-de-l-avent-54e3a.appspot.com",
            messagingSenderId: "850639567855",
            appId: "1:850639567855:web:0d799a1ecca005fcff141a",
            measurementId: "G-PC1W7RYVEH"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let userId = '';
        let score = 0;
        let playCount = 0;
        let totalPlayCountGame16 = 0;
        let highestScore = 0;
        let questionIndex = 0;
        let timer; 

        const startBtn = document.getElementById('start-btn');
        const timerDisplay = document.getElementById('timer');
        const scoreDisplay = document.getElementById('score');
        const questionDisplay = document.getElementById('question');
        const optionsDisplay = document.getElementById('options');
        const inputField = document.getElementById('input');
        const nextquestionbtn = document.getElementById('next-question-btn');


        const questions = [
        
            {
                question: "Selon No√©mie, qui est le/la plus sensible ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "C"
            },
                        {
                question: "Selon Loris, qui est le/la plus sensible ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "E"
            },
                        {
                question: "Selon Romain, qui ferait le/la meilleur.e d√©tective ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "B"
            },
                        {
                question: "Selon Romain, qui offre les meilleurs cadeaux de No√´l ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "A"
            },
                        {
                question: "Selon Adrien, qui offre les meilleurs cadeaux de No√´l ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "A"
            },
                        {
                question: "Selon Thadd√©e, qui est le/la plus bord√©lique?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Selon Adrien, qui est le/la plus bord√©lique?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "E"
            },
                        {
                question: "Selon Thadd√©e, Qui est le/la plus sportif.ve?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Selon Loris, Qui est le/la plus sportif.ve?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "B"
            },
                        {
                question: "Selon Romain, qui est le/la plus organis√©.e ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "C"
            },
                        {
                question: "Selon Thadd√©e, qui est le/la plus comp√©titif.ve ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Selon Romain, qui serait le/la meilleur.e acteur/actrice dans un film ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "B"
            },
                        {
                question: "Selon Romain, qui est le/la plus accro.e √† son t√©l√©phone ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "E"
            },
                        {
                question: "Selon Adrien, qui est le/la plus accro.e √† son t√©l√©phone ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Selon Adrien, qui a le plus de chances de devenir c√©l√®bre ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "E"
            },
                        {
                question: "Selon No√©mie, qui est le/la plus dou√©.e pour raconter des blagues nulles ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "A"
            },
                        {
                question: "Selon Thadd√©e, qui dessine le plus mal ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Selon Loris, qui dessine le plus mal ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "E"
            },
                        {
                question: "Selon Adrien, qui a les plus mauvais go√ªts musicaux ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "E"
            },
                        {
                question: "Selon No√©mie, qui est le/la plus d√©pensier.e ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "E"
            },
                        {
                question: "Selon Adrien, qui est le/la plus dr√¥le sans vraiment le vouloir?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "B"
            },
                        {
                question: "Avec qui, Romain, aurait envie de faire un duo pour Qui veut gagner des millions ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Avec qui, Adrien, aurait envie de faire un duo pour Qui veut gagner des millions ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "C"
            },
                        {
                question: "Avec qui, No√©mie, aurait envie de faire un duo pour Qui veut gagner des millions ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "C"
            },
                        {
                question: "Avec qui, Loris, aurait envie de faire un duo pour Qui veut gagner des millions ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Avec qui, Thadd√©e, aurait envie de faire un duo pour Qui veut gagner des millions ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "A"
            },
                        {
                question: "Selon Thadd√©e, qui est le/la plus insupportable apr√®s une victoire sur la Switch (Mario Party, Towerfall,..) ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Selon Loris, qui est le/la plus insupportable apr√®s une victoire sur la Switch (Mario Party, Towerfall,..) ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Selon No√©mie, est le/la meilleur.e cuisinier.e ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "C"
            },
                        {
                question: "Selon Romain, est le/la meilleur.e cuisinier.e ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "C"
            },
                        {
                question: "Selon Loris, qui fait les meilleurs compliments ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "A"
            },
                        {
                question: "Selon No√©mie, qui fait les meilleurs compliments ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "A"
            },
                        {
                question: "Selon Romain, qui est le/la plus dou√©e pour mentir sans se faire attraper ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "B"
            },
                        {
                question: "Selon Adrien, qui est le/la plus dou√©e pour mentir sans se faire attraper ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "B"
            },
                        {
                question: "Selon No√©mie, est le/la plus t√™tu.e ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Selon Loris, est le/la plus t√™tu.e ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "C"
            },
                        {
                question: "Selon No√©mie, qui est le plus susceptible d‚Äôavoir toujours la m√™me commande au restaurant ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "B"
            },
                        {
                question: "Selon Thadd√©e, qui est le plus susceptible d‚Äôavoir toujours la m√™me commande au restaurant ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "E"
            },
                        {
                question: "Selon Thadd√©e, qui est le/la plus gros l√¢cheur.euse ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            },
                        {
                question: "Selon Loris, qui est le/la plus gros l√¢cheur.euse ?",
                options: ["A) Romain", "B) Adrien", "C) No√©mie", "D) Loris", "E)Thadd√©e"],
                answer: "D"
            }
            
        ];

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                document.getElementById('userStatus').innerText = `Welcome: ${user.email}`;

                const userRef = doc(db, 'users', userId);
                const docSnap = await getDoc(userRef);

                if (!docSnap.exists()) {
                    await setDoc(userRef, { userId: userId, totalPlayCountGame16: 0, highestScoreGame16: 0 });
                    console.log("User document created with initial values.");
                } else {
                    const userData = docSnap.data();
                    totalPlayCountGame16 = userData.totalPlayCountGame16 || 0;
                    highestScore = userData.highestScoreGame16 || 0;
                    playCount = totalPlayCountGame16 + 1;
                    console.log(`Loaded totalPlayCountGame16: ${totalPlayCountGame16}, highestScore: ${highestScore}`);
                }
            } else {
                window.location.href = 'login.html';
            }
        });

startBtn.addEventListener('click', async () => {
    score = 0;
    scoreDisplay.innerText = `Current Score: ${score}`;
    inputField.value = '';
    inputField.disabled = false;
    timerDisplay.innerText = '';
    optionsDisplay.innerHTML = '';

    // Increment totalPlayCount and update Firestore
    totalPlayCountGame16 += 1;
    await updateDoc(doc(db, 'users', userId), { totalPlayCountGame16: totalPlayCountGame16 });

    questionIndex = 0;
    showQuestion(questionIndex);

    timer = startTimer(); // Start the timer for the first question

    inputField.addEventListener('keyup', (event) => {
        if (event.key === 'Enter' && inputField.value) {
            clearInterval(timer); // Clear the current timer
            checkAnswer(questionIndex, inputField.value.toUpperCase());
            inputField.value = '';

        }
    });
});
document.getElementById('next-question-btn').addEventListener('click', () => {
    questionIndex++;
    if (questionIndex < questions.length) {
        showQuestion(questionIndex);
        startTimer();
        document.getElementById('next-question-btn').style.display = 'none'; // Hide the button again
    } else {
        endGame();
    }
});
      
function startTimer() {
    let timeLeft = 30; // Set time left for each question
    timerDisplay.innerText = `Temps restant: ${timeLeft}s`;

    clearInterval(timer);
    timer = setInterval(() => {
        timeLeft -= 1;
        timerDisplay.innerText = `Temps restant: ${timeLeft}s`;

        if (timeLeft <= 0) {
            clearInterval(timer);
            inputField.disabled = true; // Disable input after time runs out
            checkAnswer(questionIndex, ''); // Check answer as incorrect if time is up
           document.getElementById('next-question-btn').style.display = 'inline'; // Show "Next Question" button
            
        }
    }, 1000);

    return timer; // Return timer reference for clearing if needed
}


function showQuestion(index) {
    clearInterval(timer);
    const question = questions[index];
    questionDisplay.innerText = question.question;
    optionsDisplay.innerHTML = question.options.join('<br>');
    timerDisplay.innerText = `Temps restant : 30s`;
    inputField.disabled = false;
    inputField.focus();
    timer = startTimer();
}

        function checkAnswer(index, userAnswer) {
            const correctAnswer = questions[index].answer;
            if (userAnswer === questions[index].answer) {
                score += 2.5;
                scoreDisplay.innerText = `Score actuel: ${score}`;
                console.log("Correct Answer!");
            } else if (userAnswer !== '') {
                console.log("Incorrect Answer.");
            }
          questionDisplay.innerHTML += `<br><strong>R√©ponse correcte : ${correctAnswer}</strong>`;
          inputField.disabled = true;
          document.getElementById('next-question-btn').style.display = 'inline'; // Show "Next Question" button
        }

        async function saveScore(score) {
            try {
                const gameData = { score: score, playCount: playCount, timestamp: new Date() };
                await addDoc(collection(db, 'users', userId, 'Game16'), gameData);

                const userRef = doc(db, 'users', userId);
                if (totalPlayCountGame16 <= 1 &&score > highestScore) {
                    highestScore = Math.ceil(score);
                    await updateDoc(userRef, { highestScoreGame16: highestScore });
                }
                console.log("Score saved successfully.");
            } catch (error) {
                console.error("Error saving score:", error);
            }
        }

        async function endGame() {
            inputField.disabled = true;
            await saveScore(score); // Save the score at the end of the game
            console.log("Game Over. Final Score:", score);
            alert(`Le quiz est fini! Nono et Thadd√©e, arr√™tez de rager sur certaines questions! Votre score final est: ${score}`);
        }
    </script>
</body>
</html>
