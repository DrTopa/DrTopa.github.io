<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Ready Player One </title>
    <style>
        /* General body styling */
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            background-color: #ffebcd;
            background-image: url('https://www.transparenttextures.com/patterns/snow.png');
            margin: 0;
            overflow-y: auto;
        }

        /* Christmas themed title */
        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #d32f2f;
            font-family: 'Comic Sans MS', cursive;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
        }

        /* User status */
        #userStatus {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.2em;
            color: #a23636;
        }

        /* Instructions section */
        #instructions {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            text-align: center;
            max-width: 1000px;
            font-size: 1.2em;
            color: #333;
            overflow-y: auto;  /* Added for scrolling if needed */
            max-height: 300px; /* Set a maximum height */
        }

        /* Score button styling */
        #increaseScoreBtn {
            padding: 10px 20px;
            font-size: 1em;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        #increaseScoreBtn:hover {
            background-color: #45a049;
        }

        /* Textarea styling */
        #textArea {
            display: none;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            text-align: center;
            max-width: 1000px;
            font-size: 1.2em;
            color: #333;
            overflow-y: auto;  /* Added for scrolling if needed */
            max-height: 500px; /* Set a maximum height */
        }
    </style>
</head>
<body>
    <h1>🎄 Ready Player One 🎄</h1>
        <!-- Game instructions -->
    <div id="instructions">
        <p>Félicitations, vous avez trouvé l'Easter Egg caché du site. Vous pouvez appuyer sur le bouton ci-dessus pour gagner votre récompense</p>
    </div>

  
    <!-- Score button -->
    <button id="increaseScoreBtn">Cliquez ici </button>

    <!-- Text area -->
    <div id="textArea">
        <p>Je me suis toujours dit que si la vie était un jeu, alors j’avais déjà gagné avant même de commencer.</p>
 <p>J’ai eu la chance incroyable de ne pas connaître d’événements tragiques ou dramatiques au cours de ma vie. Tout s’est toujours bien passé. Alors, forcément, c’est facile d’être heureux et souriant quand la vie est douce avec toi. Mais s’il y a un moment où je me suis senti un peu au plus bas, ce serait avant ma soutenance de thèse. À ce moment-là, ça n’allait pas fort. Mon réflexe, alors, a été de rentrer à la maison pour un week-end. Et ça m’a fait un bien fou de passer ces quelques jours en famille, surtout en jouant à nos jeux.</p>
 <p>Nous avons cette chance incroyable : celle de bien nous entendre et de toujours trouver le moyen de nous amuser ensemble. J’ai participé à beaucoup de soirées jeux avec des amis, mais aucune n’arrive à la hauteur de nos parties enflammées de Solo Bonbon ou de nos rages légendaires sur Galérapagos. De jeu en jeu, cette complicité m’a donné l’envie de créer, d’expérimenter, parce que j’ai la chance d’avoir un public toujours prêt à tester mes idées, qu’elles soient géniales ou complètement ratées. À chaque fois, j’essaie. Si ça marche, tant mieux ; sinon, on passe à autre chose.</p>
 <p>Petit à petit, ces expériences m’ont permis d’aller plus loin : de simples chasses au trésor à des jeux d’été, des jeux de société, et même des sites internet. Et je réalise que consacrer des soirées, voire des week-ends entiers à travailler sur ces projets, ne me dérange pas. Bien au contraire, ça me comble, parce que ces moments sont l’occasion de partager quelque chose de précieux avec vous. J’aime organiser des activités qui nous rassemblent, mais ce qui me touche encore plus, c’est de voir que vous prenez aussi le relais pour créer vos propres jeux (à l’exception, bien sûr, de la fameuse chasse au trésor de Romain).</p>
 <p>C’est remarquable à quel point nous apprécions passer du temps ensemble. Rien qu’à nous voir, impatients comme des enfants à l’approche de Noël, à l’idée de nous retrouver tous les cinq, on comprend à quel point ce lien est fort. Comme sur BGA, où une partie en appelle toujours une autre, même après quatre heures en ligne, parce qu’on ne veut tout simplement pas s’arrêter.</p>
 <p>Et j’espère que, malgré les années qui passeront, ce plaisir ne changera jamais. Que nous continuerons à nous retrouver les week-ends pour jouer à la Nintendo Switch 4, tout en écoutant Romain râler que "la Wii, c’était quand même mieux". Que nous continuerons à enchaîner les soirées jeux jusqu’à ce que le sommeil nous rattrape. Et surtout, qu’un jour, à la manière des Tata, nous ne serons plus dispersés aux quatre coins de l’Europe, et que nous pourrons nous retrouver chaque week-end pour élire le meilleur Bobby du groupe.</p>
 <p>Alors, merci. Merci d’avoir joué à mes jeux, de m’avoir donné la motivation de les inventer, et l’envie de toujours en faire plus. Merci d’être les meilleurs partenaires de jeu, les meilleurs frères et sœur qu’on puisse rêver.</p>
 <p>Parce que si la vie est un jeu, alors, tous ensemble, nous avons déjà gagné avant même de commencer. Parce qu’on y joue à cinq.</p>
 <p>Je vous aime si fort, et je mesure chaque jour la chance que j’ai de vous avoir.
 
</p>
    </div>

    <div id="userStatus"></div>

    <script defer type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC4bjg7lVwd8FU8MREaPhBsBENv5qmiYYM",
            authDomain: "calendrier-de-l-avent-54e3a.firebaseapp.com",
            databaseURL: "https://calendrier-de-l-avent-54e3a-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "calendrier-de-l-avent-54e3a",
            storageBucket: "calendrier-de-l-avent-54e3a.appspot.com",
            messagingSenderId: "850639567855",
            appId: "1:850639567855:web:0d799a1ecca005fcff141a",
            measurementId: "G-PC1W7RYVEH"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let userId = '';
        let highestScore = 0;
        let score = 0; 

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                document.getElementById('userStatus').innerText = `Bienvenue : ${user.email}`;

                const userRef = doc(db, 'users', userId);
                const docSnap = await getDoc(userRef);

                if (!docSnap.exists()) {
                    await setDoc(userRef, { userId: userId, highestScoreGame25: 0, UserEmail: user.email });
                } else {
                    const userData = docSnap.data();
                    highestScore = userData.highestScoreGame25 || 0;
                }
            } else {
                window.location.href = 'login.html';
            }
        });

        document.getElementById('increaseScoreBtn').addEventListener('click', () => {
            // Increase score
            score += 10;
            console.log(`Score actuel : ${score}`);

            // Hide button
            document.getElementById('increaseScoreBtn').style.display = 'none';

            // Show text area
            document.getElementById('textArea').style.display = 'block';

          saveScore (score);
        });

        async function saveScore(score) {
            try {
                const gameData = { timestamp: new Date(), score: score };
                await addDoc(collection(db, 'users', userId, 'Game25'), gameData);

                const userRef = doc(db, 'users', userId);
                if (score > highestScore) {
                    highestScore = score;
                    await updateDoc(userRef, { highestScoreGame25: highestScore });
                }
            } catch (error) {
                console.error("Error saving score:", error);
            }
        }
    </script>
</body>
</html>
