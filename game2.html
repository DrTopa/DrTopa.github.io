<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comparatif 2010 vs 2024 - Game 2 </title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            background-color: #ffebcd;
            background-image: url('https://www.transparenttextures.com/patterns/snow.png');
            margin: 0;
        }
        /* Christmas themed title */
        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            color: #d32f2f;
            font-family: 'Comic Sans MS', cursive;
            text-shadow: 2px 2px 5px rgba(0, 0, 0, 0.3);
        }
        #userStatus {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 1.2em;
        }
                
        /* Instructions section */
        #instructions {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
            text-align: center;
            max-width: 1000px;
            font-size: 1.2em;
            color: #333;
            overflow-y: auto;  /* Added for scrolling if needed */
            max-height: 300px; /* Set a maximum height */
        }
        #gameArea {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 50px;
        }
        #start-btn {
            padding: 10px 20px;
            margin: 10px;
            font-size: 1.5em;
            cursor: pointer;
            background-color: #007BFF;
            color: white;
            border: none;
        }
        #start-btn:hover {
            background-color: #0056b3;
        }
        #question {
            font-size: 1.5em;
            margin: 20px;
        }
        #options {
            font-size: 1.2em;
            margin: 10px;
        }
        #timer, #score {
            font-size: 1.5em;
            margin: 10px;
        }
        #input {
            padding: 10px;
            font-size: 1.2em;
            margin: 10px;
            width: 50px;
        }
      
      

    </style>
</head>
<body>

    <h1>ðŸŽ… Comparatif 2010 vs 2024 - Game 2 ðŸŽ…</h1>
    <div id="userStatus"></div>
    
 <!-- Game instructions -->
    <div id="instructions">
        <p>Le dos fourbu aprÃ¨s quelques coups de ceinture bien mÃ©ritÃ©s, bÃ©bÃ© Romain se mit Ã  lâ€™ouvrage, en tentant de fabriquer des systÃ¨mes solaires motorisÃ©s. </p>
        <p>Â« Qui joue avec ces jeux dÃ©biles, se dit-il en soupirant ? C'est pour ThadÃ©e, peut-Ãªtre ? Encore un Dudley qui ne le mÃ©rite pas. Â»</p>
        <p>Il sâ€™imagine cet enfant, en classe de 3e, probablement en train dâ€™apprendre ses tables de multiplication. Â« Ã€ mon Ã©poque, câ€™Ã©tait autre chose ! Â» pense-t-il</p>
        <p>Il se souvient de la fiertÃ© qui accompagnait chaque note : un 15 sur 20 Ã©tait alors un exploit,. Â« Ah, de nos jours, il suffit de savoir compter sur ses doigts pour Ãªtre sur le podium dâ€™un concours de maths. Â»</p> 
        <p>Pendant leur courte pause entre 1h et 1h15 du matin, BÃ©bÃ© Romain dÃ©cida de se plonger dans les lÃ©gendaires archives des Nathan (jâ€™ai la ref). Pour les atteindre, il descendit dans une vieille cave sombre, autrefois fosse septique. Alors quâ€™il fouillait dans la poussiÃ¨re, une araignÃ©e surgit soudain, suspendue Ã  sa toile. BÃ©bÃ© Romain Ã©touffa un cri aigu et murmura pour se rassurer : Â« Heureusement que Dudley nâ€™est pas lÃ â€¦ Perdre ma crÃ©dibilitÃ© parce quâ€™une araignÃ©e mâ€™a surpris, ce serait trop. Â» Un pholque se mit Ã  vibrer sur sa toile, espÃ©rant se fondre dans lâ€™ombre. Mais le lutin, sans pitiÃ©, saisit le vieux Dyson posÃ© dans un coin, et aspira la pauvre crÃ©ature qui eut juste le temps de murmurer Ã  ses enfants : Â« Adieu, Kevin et Brandonâ€¦ Maman vous aime. Â»</p>
<p>DÃ©lestÃ© de cette menace Ã  huit pattes, dont les deux de devant plus grandes, BÃ©bÃ© Romain continua Ã  fouiller. Il tomba bientÃ´t sur des trÃ©sors oubliÃ©s : des exemplaires du Journal de Mickey, des Super Picsou GÃ©ant et des Mickey Parade. Mais le vrai joyau apparut enfin : La Jeunesse de Picsou de Don Rosa. Â« Ah, le chef-d'Å“uvre absolu Â», murmura-t-il, fascinÃ©, avant de se plonger dans la lecture.</p>
<p>Deux heures plus tard, il Ã©mergea de sa plongÃ©e nostalgique, se rappelant soudain quâ€™il Ã©tait lÃ  pour retrouver les Nathan. Il ouvrit Ã  nouveau les cartons, jusquâ€™Ã  dÃ©nicher deux vieux lutins poussiÃ©reux. Â« Nathan ? Â» demanda-t-il. Â« Non, moi câ€™est Yoshi, et lui câ€™est Dod Â», rÃ©pondit lâ€™un dâ€™eux. Â« Ah, ok, câ€™est ciao Â», dit BÃ©bÃ© Romain en refermant le carton.</p>
<p>Enfin, aprÃ¨s plusieurs cartons retournÃ©s, il tomba sur les fameux cahiers Nathan, le Graal ultime. Il se rappela que c'Ã©tait lui-mÃªme qui les avait confectionnÃ©s, annÃ©e aprÃ¨s annÃ©e. Il pouffa de rire : Â« Des cahiers de vacances pour NoÃ«l, sÃ©rieux ! Qui ferait Ã§a ? Non je dÃ©conne â€¦ Mais imagine quand mÃªmeÂ» Il ouvrit alors les annales pour comparer les questions de 2010 et de 2024.</p>

        <p>Explication du jeu : Simple quizz de maths. RÃ©ponds par A,B,C ou D en appuyant sur entrÃ©e (majuscule ou minuscule) Ã  chaque question. Tu disposes de 30 secondes par question et chaque bonne rÃ©ponse vaut 5 points.</p>
        <p>Les 10 premiÃ¨res questions sont issues de diverses interros en 2024 et les 10 derniÃ¨res dâ€™interro en 2010. Il est possible de refaire le quizz mais seul le premier score est pris en compte. Possible sur Smartphone.
</p>
    </div>
    
    <div id="gameArea">
        <button id="start-btn">ðŸŽ…Start GameðŸŽ…</button>
        <div id="timer"></div>
        <div id="score"></div>
        <div id="question"></div>
        <div id="options"></div>
        <input type="text" id="input" placeholder="A/B/C/D" maxlength="1" disabled>
    </div>

    <script defer type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, updateDoc, collection, addDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyC4bjg7lVwd8FU8MREaPhBsBENv5qmiYYM",
            authDomain: "calendrier-de-l-avent-54e3a.firebaseapp.com",
            databaseURL: "https://calendrier-de-l-avent-54e3a-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "calendrier-de-l-avent-54e3a",
            storageBucket: "calendrier-de-l-avent-54e3a.appspot.com",
            messagingSenderId: "850639567855",
            appId: "1:850639567855:web:0d799a1ecca005fcff141a",
            measurementId: "G-PC1W7RYVEH"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let userId = '';
        let score = 0;
        let playCount = 0;
        let totalPlayCountGame2 = 0;
        let highestScore = 0;

        const startBtn = document.getElementById('start-btn');
        const timerDisplay = document.getElementById('timer');
        const scoreDisplay = document.getElementById('score');
        const questionDisplay = document.getElementById('question');
        const optionsDisplay = document.getElementById('options');
        const inputField = document.getElementById('input');


        const questions = [
            {
                question: "Niveau 3e (2024) : Si je multiplie deux nombres pairs alors j'obtiens un nombre ..",
                options: ["A) Pair", "B) Impair", "C) Complexe", "D) Quoicoubeix"],
                answer: "A"
            },
            {
                question: "Niveau 3e (2024) : 8 * 7 = ?",
                options: ["A) 54", "B) 45", "C) 56", "D) 87"],
                answer: "C"
            },
            {
                question: "Niveau 3e (2024) : Quel nombre est plus petit que 17 ?",
                options: ["A) 1881/99", "B) 7Â²/2", "C) 18", "D) 16"],
                answer: "D"
            },
            {
                question: "Niveau 2nd (2024) : A combien est Ã©gal la racine de 9 ?",
                options: ["A) 3", "B) -3", "C) 3 et -3", "D) Gnia Gnia, tu sais pas faire la forme racine en HTML"],
                answer: "A"
            },
            {
                question: "Niveau 2nd (2024) : A quel thÃ©orÃ¨me peut-on associer cette phrase : Dans tout triangle rectangle, le carrÃ© de la longueur de l'hypotÃ©nuse est Ã©gal Ã  la somme des carrÃ©s des longueurs des deux autres cÃ´tÃ©s.",
                options: ["A) ThalÃ¨s", "B) Pythagore", "C) Venn-Pearson", "D) A.Topalian"],
                answer: "B"
            },
            {
                question: "Niveau 2nd (2024) : A quel thÃ©orÃ¨me peut-on associer cette phrase : Si deux droites sont parallÃ¨les et coupÃ©es par deux sÃ©cantes, alors les rapports des segments dÃ©terminÃ©s sur ces sÃ©cantes sont Ã©gaux.",
                options: ["A) ThalÃ¨s", "B) Pythagore", "C) Venn-Pearson", "D) A.Topalian"],
                answer: "A"
            },
            {
                question: "Niveau 1er (2024) : Quelle est la formule d'une volume d'une sphÃ¨re",
                options: ["A) Ï€rÂ² ", "B) (4Ï€r^3)/3", "C) (2Ï€r^3)/3", "D) (4Ï€r^2)"],
                answer: "B"
            },
            {
                question: "Niveau Terminale (2024) : Si sin (60Â°) = X, quelle est la valeur de X ",
                options: ["A) 0.5", "B) (3^0.5)/3", "C) (2^0.5)/2", "D) (3^0.5)*0.5"],
                answer: "D"
            },
            {
                question: "Niveau Terminale (2024) : Paul a 8 pommes, Alfred en mange 2. Combien Alfred en a t-il mangÃ©? ",
                options: ["A) 2", "B) 4", "C) 6", "D) 8"],
                answer: "A"
            },
            {
                question: "Niveau Terminale (2024) : Quelle est la bonne orthographe de cette inÃ©galitÃ© (en franÃ§ais) ?",
                options: ["A) BienaimÃ©-Tchebychev", "B) BienaymÃ©-Tchebychev", "C) BienaymÃ©-Tchebitchev", "D) BienaimÃ©-Tchebitchev"],
                answer: "B"
            },
            {    
                question: "Niveau 3e (2010) : Quelle est la formule de la somme des n premiers entiers ?",
                options: ["A) n*(n+1) /2 ", "B) n*(n-1) /2", "C) nÂ²/2", "D)  n(n-1)"],
                answer: "A"
            },
            {
                question: "Niveau 3e (2010): Quel est le rÃ©sultat de log (ab) ?",
                options: ["A) log (a) - log (b)", "B) log (a) * log (b)", "C) log (a+b) ", "D) log (a) + log (b)"],
                answer: "D"
            },
            {
                question: "Niveau 2nd (2010) : A quel thÃ©orÃ¨me peut-on associer cette phrase : Si p est un nombre premier et a est un entier qui n'est pas divisible par p alors a^(p-1) â‰¡ 1 (mod p) ",
                options: ["A) Bezout", "B) Fermat", "C) Baire", "D) Cauchy"],
                answer: "B"
            },
            {
                question: "Niveau 2nd (2010) : A quel thÃ©orÃ¨me peut-on associer cette phrase : Si a et b deux entiers, il existe des entiers x et y tels que ax+by=PGCD(a,b)",
                options: ["A) Bezout", "B) Fermat", "C) Baire", "D) Cauchy"],
                answer: "A"
            },
            {
                question: "Niveau 2nd (2010) : Si une fonction est continue sur un intervalle fermÃ© et dÃ©rivable sur l'intervalle ouvert, et qu'elle prend la mÃªme valeur aux extrÃ©mitÃ©s, alors il existe un point oÃ¹ la dÃ©rivÃ©e est nulle.",
                options: ["A) Rolle", "B) Taylor", "C) Baire", "D) Gauss"],
                answer: "A"
            },
            {
                question: "Niveau 1ere (2010) : Quel est le rang maximale d'une matrice 2 * 3",
                options: ["A) 1", "B) 2", "C) 3", "D) 4"],
                answer: "B"
            },
            {
                question: "Niveau 1ere (2010) : Application bijective qui prÃ©serve la structure, et dont la rÃ©ciproque prÃ©serve aussi la structure entre deux ensembles structurÃ©s",
                options: ["A) Isomorphisme", "B) Endomorphisme", "C) Automorphisme", "D) Ker(Im) euuuuhhhh"],
                answer: "A"
            },
            {
                question: "Niveau 1ere (2010) : Somme des angles d'un polygone Ã  n cÃ´tÃ©s",
                options: ["A) (n-2)*90", "B) (n-2)*180", "C) n*90", "D) n*180"],
                answer: "B"
            },
            {
                question: "Niveau 1ere (2010) : Quel est le produit scalaire des vecteurs u ( 2,3) et v = (4, -1)",
                options: ["A) 10", "B) 14", "C) 5", "D) 11"],
                answer: "C"
            },
            {
                question: "Niveau Terminale (2010) : Paul a 8 pommes, Alfred en mange 2. Quelle est la masse du soleil en kg?",
                options: ["A) 10^25", "B) 10^27", "C) 10^30", "D) 10^32"],
                answer: "C"
            },
            {
                question: "Niveau Terminale (2010) : Quelle dÃ©couverte mathÃ©matique majeure sera dÃ©montrÃ©e en 2024 ? ",
                options: ["A) La thÃ©orie de Yang-Mills", "B) Le P problÃ¨me et le NP problÃ¨me", "C) La conjecture de Hodge", "D)La correspondance de Langlands"],
                answer: "D"
            }
        ];

        onAuthStateChanged(auth, async (user) => {
            if (user) {
                userId = user.uid;
                document.getElementById('userStatus').innerText = `Welcome: ${user.email}`;

                const userRef = doc(db, 'users', userId);
                const docSnap = await getDoc(userRef);

                if (!docSnap.exists()) {
                    await setDoc(userRef, { userId: userId, totalPlayCountGame2: 0, highestScoreGame2: 0 });
                    console.log("User document created with initial values.");
                } else {
                    const userData = docSnap.data();
                    totalPlayCountGame2 = userData.totalPlayCountGame2 || 0;
                    highestScore = userData.highestScoreGame2 || 0;
                    playCount = totalPlayCountGame2 + 1;
                    console.log(`Loaded totalPlayCountGame2: ${totalPlayCountGame2}, highestScore: ${highestScore}`);
                }
            } else {
                window.location.href = 'login.html';
            }
        });

        startBtn.addEventListener('click', async () => {
    score = 0;
    scoreDisplay.innerText = `Current Score: ${score}`;
    inputField.value = '';
    inputField.disabled = false;
    timerDisplay.innerText = '';
    optionsDisplay.innerHTML = '';

    // Increment totalPlayCount and update Firestore
    totalPlayCountGame2 += 1;
    await updateDoc(doc(db, 'users', userId), { totalPlayCountGame2: totalPlayCountGame2 });

    let questionIndex = 0;
    showQuestion(questionIndex);

    let timer = startTimer(); // Start the timer for the first question

    inputField.addEventListener('keyup', (event) => {
        if (event.key === 'Enter' && inputField.value) {
            clearInterval(timer); // Clear the current timer
            checkAnswer(questionIndex, inputField.value.toUpperCase());
            questionIndex++;
            inputField.value = '';

            if (questionIndex < questions.length) {
                showQuestion(questionIndex);
                timer = startTimer(); // Start the timer for the next question
            } else {
                endGame();
            }
        }
    });
});

           function startTimer() {
    let timeLeft = 30; // Set time left for each question
    timerDisplay.innerText = `Temps restant: ${timeLeft}s`;

    const timer = setInterval(() => {
        timeLeft -= 1;
        timerDisplay.innerText = `Temps restant: ${timeLeft}s`;

        if (timeLeft <= 0) {
            clearInterval(timer);
            inputField.disabled = true; // Disable input after time runs out
            checkAnswer(questionIndex, ''); // Check answer as incorrect if time is up
            questionIndex++;
            
            if (questionIndex < questions.length) {
                showQuestion(questionIndex);
                timer = startTimer(); // Start the timer for the next question
            } else {
                endGame();
            }
        }
    }, 1000);

    return timer; // Return timer reference for clearing if needed
}


function showQuestion(index) {
    const question = questions[index];
    questionDisplay.innerText = question.question;
    optionsDisplay.innerHTML = question.options.join('<br>');
    timerDisplay.innerText = `Temps restant : 30s`;
    inputField.disabled = false;
    inputField.focus();
}

        function checkAnswer(index, userAnswer) {
            if (userAnswer === questions[index].answer) {
                score += 5;
                scoreDisplay.innerText = `Score actuel: ${score}`;
                console.log("Correct Answer!");
            } else if (userAnswer !== '') {
                console.log("Incorrect Answer.");
            }
        }

        async function saveScore(score) {
            try {
                const gameData = { score: score, playCount: playCount, timestamp: new Date() };
                await addDoc(collection(db, 'users', userId, 'Game2'), gameData);

                const userRef = doc(db, 'users', userId);
                if (totalPlayCountGame2 <= 1 &&score > highestScore) {
                    highestScore = score;
                    await updateDoc(userRef, { highestScoreGame2: highestScore });
                }
                console.log("Score saved successfully.");
            } catch (error) {
                console.error("Error saving score:", error);
            }
        }

        async function endGame() {
            inputField.disabled = true;
            await saveScore(score); // Save the score at the end of the game
            console.log("Game Over. Final Score:", score);
            alert(`Le quiz est fini! Nono et ThaddÃ©e, arrÃªtez de rager sur certaines questions! Votre score final est: ${score}`);
        }
    </script>
</body>
</html>
